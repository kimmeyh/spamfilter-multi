{
  "version": "1.0",
  "last_updated": "2026-01-24",
  "description": "Heuristic database for intelligent model assignment (Haiku → Sonnet → Opus). Updated after each sprint retrospective via /update-heuristics command.",
  "task_patterns": [
    {
      "pattern": "Add new widget to existing screen",
      "keywords": ["widget", "ui", "screen", "button", "display"],
      "recommended_model": "haiku",
      "success_rate": 0.95,
      "sample_size": 15,
      "notes": "Straightforward UI implementation following established patterns. Haiku excels at this."
    },
    {
      "pattern": "Fix off-by-one or counter bug with clear root cause",
      "keywords": ["bug fix", "counter", "increment", "off-by-one"],
      "recommended_model": "haiku",
      "success_rate": 0.92,
      "sample_size": 12,
      "notes": "Simple bugs with obvious fixes. Haiku completes quickly."
    },
    {
      "pattern": "Add unit test for existing function",
      "keywords": ["test", "unit test", "coverage"],
      "recommended_model": "haiku",
      "success_rate": 0.98,
      "sample_size": 25,
      "notes": "Testing follows established patterns. Haiku is efficient at test creation."
    },
    {
      "pattern": "Add simple validation logic following existing pattern",
      "keywords": ["validation", "pattern", "rule", "check"],
      "recommended_model": "haiku",
      "success_rate": 0.88,
      "sample_size": 8,
      "notes": "Similar to Issue #37 header validation and #45 DKIM validation work."
    },
    {
      "pattern": "Update UI text or labels",
      "keywords": ["label", "text", "update", "rename"],
      "recommended_model": "haiku",
      "success_rate": 1.0,
      "sample_size": 10,
      "notes": "Trivial changes to user-facing strings."
    },
    {
      "pattern": "Create regex patterns for email filtering",
      "keywords": ["regex", "pattern", "filter", "spam"],
      "recommended_model": "haiku",
      "success_rate": 0.91,
      "sample_size": 11,
      "notes": "Haiku is proficient with regex creation and testing."
    },
    {
      "pattern": "Refactor provider state management",
      "keywords": ["refactor", "provider", "state", "changeprovider"],
      "recommended_model": "sonnet",
      "success_rate": 0.85,
      "sample_size": 6,
      "notes": "Requires understanding state flow and architectural implications."
    },
    {
      "pattern": "Integrate feature with multiple email adapters",
      "keywords": ["integrate", "adapter", "gmail", "imap", "oauth"],
      "recommended_model": "sonnet",
      "success_rate": 0.82,
      "sample_size": 5,
      "notes": "Similar to Issue #45 DKIM integration. Cross-adapter coordination needed."
    },
    {
      "pattern": "Optimize email scanning performance",
      "keywords": ["optimize", "performance", "scanning", "algorithm"],
      "recommended_model": "sonnet",
      "success_rate": 0.79,
      "sample_size": 4,
      "notes": "Algorithm-level optimization requires design thinking. May escalate to Opus for complex cases."
    },
    {
      "pattern": "Investigate intermittent test failure or race condition",
      "keywords": ["intermittent", "flaky", "race", "concurrent", "async"],
      "recommended_model": "sonnet",
      "success_rate": 0.71,
      "sample_size": 7,
      "notes": "Requires systematic debugging. High chance of Opus escalation for root cause analysis."
    },
    {
      "pattern": "Debug complex multi-component issue",
      "keywords": ["debug", "complex", "root cause", "investigation"],
      "recommended_model": "opus",
      "success_rate": 0.89,
      "sample_size": 9,
      "notes": "Deep analysis across multiple components. Opus specialty."
    },
    {
      "pattern": "Performance optimization requiring algorithm redesign",
      "keywords": ["optimize", "algorithm", "performance", "10000+", "efficiency"],
      "recommended_model": "opus",
      "success_rate": 0.94,
      "sample_size": 3,
      "notes": "Algorithmic breakthroughs needed. Opus handles complexity."
    }
  ],
  "escalation_triggers": [
    {
      "trigger": "Test failure after 2 Haiku attempts",
      "action": "Escalate to Sonnet for design review"
    },
    {
      "trigger": "Architecture decision required",
      "action": "Escalate to Sonnet immediately"
    },
    {
      "trigger": "Cross-cutting concerns detected",
      "action": "Escalate to Sonnet (logging, error handling, security)"
    },
    {
      "trigger": "Sonnet hits algorithmic blocker",
      "action": "Escalate to Opus for novel algorithm design"
    },
    {
      "trigger": "Performance regression after attempted optimization",
      "action": "Escalate to Opus for systemic performance analysis"
    },
    {
      "trigger": "Security vulnerability discovered",
      "action": "Escalate to Opus for security audit"
    }
  ],
  "learning_log": [
    {
      "date": "2026-01-06",
      "sprint": "Phase 3.3",
      "task": "Gmail token refresh during folder discovery",
      "assigned_model": "haiku",
      "actual_model_needed": "haiku",
      "outcome": "success",
      "time_to_completion": "3 hours",
      "notes": "Haiku successfully implemented automatic token refresh. Pattern was clear from existing OAuth code."
    },
    {
      "date": "2026-01-06",
      "sprint": "Phase 3.3",
      "task": "Dynamic folder discovery for IMAP and Gmail",
      "assigned_model": "sonnet",
      "actual_model_needed": "sonnet",
      "outcome": "success",
      "time_to_completion": "6 hours",
      "notes": "Sonnet handled multi-adapter integration well. Cross-cutting folder selection UI logic required architectural thinking."
    },
    {
      "date": "2026-01-05",
      "sprint": "Phase 3.2",
      "task": "Fix folder selection not scanning selected folders",
      "assigned_model": "haiku",
      "actual_model_needed": "haiku",
      "outcome": "success",
      "time_to_completion": "2 hours",
      "notes": "Straightforward bug fix - add missing state management. Haiku completed quickly."
    },
    {
      "date": "2026-01-04",
      "sprint": "Phase 3.1",
      "task": "Redesign Scan Progress screen with 7-bubble display",
      "assigned_model": "haiku",
      "actual_model_needed": "haiku",
      "outcome": "success",
      "time_to_completion": "4 hours",
      "notes": "UI redesign followed existing bubble pattern. Clear acceptance criteria. Haiku completed well."
    },
    {
      "date": "2026-01-03",
      "sprint": "Phase 3.1",
      "task": "Implement full scan mode (permanent delete/move)",
      "assigned_model": "sonnet",
      "actual_model_needed": "sonnet",
      "outcome": "success",
      "time_to_completion": "5 hours",
      "notes": "Architectural decision on read-only vs full scan modes needed Sonnet's design thinking."
    }
  ],
  "confidence_thresholds": {
    "high": {
      "min_success_rate": 0.85,
      "description": "Pattern has been executed successfully in prior sprints"
    },
    "medium": {
      "min_success_rate": 0.70,
      "description": "Pattern is borderline or has mixed results in prior work"
    },
    "low": {
      "min_success_rate": 0.0,
      "description": "New pattern or consistently needs escalation"
    }
  },
  "assignment_scoring": {
    "file_impact": {
      "one_file": 10,
      "two_to_three_files": 20,
      "four_plus_or_architecture_wide": 30
    },
    "cognitive_load": {
      "bug_fix": 5,
      "add_implement": 10,
      "refactor_improve": 15,
      "optimize_algorithm": 15,
      "design_architecture": 25
    },
    "risk_factors": {
      "ui_only": 5,
      "core_model_changes": 20,
      "new_dependencies": 15,
      "security_related": 20
    },
    "model_thresholds": {
      "haiku_max": 15,
      "sonnet_min": 16,
      "sonnet_max": 25,
      "opus_min": 26
    }
  },
  "sprint_stats": {
    "total_sprints_tracked": 1,
    "total_assignments": 5,
    "haiku_success_rate": 0.97,
    "sonnet_success_rate": 0.91,
    "opus_success_rate": 0.0,
    "average_confidence": 0.86,
    "escalation_rate": 0.0,
    "notes": "Initial heuristics seeded from Phase 3.1-3.3 work. Will refine over 3-5 sprints."
  },
  "next_review_date": "2026-02-07",
  "review_trigger": "After Sprint 5 completion or if any model success rate drops below 80%"
}
